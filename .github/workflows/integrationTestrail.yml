name: send-results-to-testrail
on: [workflow_dispatch]
env:
  WORKING_DIRECTORY: Demo1folder/DemoFolder/webuitest/pom.xml
jobs:
  send-test-results-to-testrail:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Set up JDK 17
      uses: actions/setup-java@v3
      with:
        java-version: '17'
        distribution: 'temurin'
        cache: maven
    - name: Build with Maven
      run: mvn test -Dtest="LoginTest"  --file "${{env.WORKING_DIRECTORY}}"    
    - name: Python setup
      if: always()
      uses: actions/setup-python@v3
      with:
        python-version: '3.10'
    - name: TestRail CLI upload results
      if: always()
      run: |
        pip install trcli
        trcli -y \
            -h https://saiaravind123.testrail.io/ \
            --project "Sample Project" \
            -u aravindsai879@gmail.com  \
            -p 9Nb3rW2TxykjsXlNGkBF  \
            parse_junit \
            --title "Automated Tests from GitHub workflow" \
            -f "Demo1folder/DemoFolder/webuitest/test-output/testng-results.xml"  
